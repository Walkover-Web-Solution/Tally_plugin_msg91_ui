import{b as ae}from"./chunk-BD7VYUVO.js";import{b as V}from"./chunk-QBOR755N.js";import"./chunk-DYV4KVQS.js";import{a as z,b as W,d as H,e as J,i as ee,m as te,o as ie,p as ne,q as re,r as oe,s as le}from"./chunk-C2QWTHSQ.js";import{A as Z,m as k,n as h,t as K,u as Q,v as X,x as Y}from"./chunk-PGL7W3XZ.js";import{a as T,c as $}from"./chunk-YMPLTWDW.js";import{a as L,b as m,d as A,e as q,f as v,h as c,i as G,j as B,k as D,l as j,m as U}from"./chunk-MOIXQHVC.js";import"./chunk-GY2SOU2E.js";import{$a as F,Eb as u,Ib as E,Jb as S,Kb as P,Sa as s,Wa as _,cc as O,db as f,dc as x,ic as I,jc as R,kb as p,nb as o,ob as r,pb as g,tb as M,vb as b,wa as C,wb as N,xa as w}from"./chunk-H3RJLV3I.js";var se=l=>({"invalid-input":l});function pe(l,n){l&1&&(o(0,"mat-error"),u(1," Only alphabets are allowed "),r())}function ue(l,n){l&1&&(o(0,"mat-error"),u(1," Only alphabets are allowed "),r())}function ce(l,n){l&1&&(o(0,"mat-error"),u(1," Invalid email format "),r())}function de(l,n){if(l&1){let t=M();o(0,"div",21)(1,"mat-form-field",10),g(2,"input",22),r(),o(3,"button",23),b("click",function(){C(t);let i=N();return w(i.verifyOtp())}),u(4,"Verify"),r()()}}var me=class l{constructor(n,t){this.store=n;this.router=t;this.otpVerified$=this.store.pipe(h(z)),this.registerUser$=this.store.pipe(h(H)),this.walletbalance$=this.store.pipe(h(J)),this.otpNotVerified$=this.store.pipe(h(W))}otpSent=!1;otpVerified=!1;balance=0;otpVerified$;otpNotVerified$;registerUser$;walletbalance$;intlPhone;ngAfterViewInit(){this.initIntl()}registrationForm=new v({user:new v({fname:new c("",[m.required,m.minLength(3),m.maxLength(24)]),lname:new c("",[m.minLength(3),m.maxLength(25)]),email:new c("",[m.required]),mobile:new c("",[m.required]),otp:new c("",[m.minLength(4),m.maxLength(4)])})});initIntl(){let n=document.querySelector("app-root")?.shadowRoot,t=document?.getElementById("mobile-input-wrapper"),e="assets/util/intl-tel-input-custom.css";t&&(this.intlPhone=new ae(t,n,e,!0))}sendotp(){let n=this.registrationForm.get("user.mobile")?.value??"";n&&(this.store.dispatch(K({mobile:n})),this.otpSent=!0)}verifyOtp(){let n=this.registrationForm.get("user.mobile")?.value??"",t=this.registrationForm.get("user.otp")?.value??"";!t||t.length!==4||(this.store.dispatch(Q({request:{mobile:n,otp:t}})),this.store.dispatch(X({response:{success:!0}})),this.otpVerified$.subscribe(e=>{}))}submit(){let n=this.registrationForm.get("user.fname")?.value??"",t=this.registrationForm.get("user.email")?.value??"",e=this.registrationForm.get("user.mobile")?.value??"";this.store.dispatch(Y({name:n,email:t,mobile:e})),this.registerUser$.subscribe(i=>{i&&(this.router.navigate(["/layout/logs"]),this.store.dispatch(Z()))}),this.walletbalance$.subscribe(i=>{i&&i.balance&&(this.balance=i.balance)})}static \u0275fac=function(t){return new(t||l)(_(k),_(V))};static \u0275cmp=F({type:l,selectors:[["app-register"]],decls:28,vars:11,consts:[[1,"d-flex","justify-content-center","align-items-center"],[1,"outline-card","reg-form"],[1,"d-flex","align-items-center","justify-content-center"],[1,"app-content","d-flex","justify-content-center","align-items-center"],[3,"formGroup"],["formGroupName","user"],[1,"d-flex","gap-2","flex-column"],["color","primary","appearance","outline",1,"w-100"],["matInput","","formControlName","fname","placeholder","Enter First Name"],[4,"ngIf"],["appearance","outline",1,"w-100"],["matInput","","formControlName","lname","placeholder","Enter Last Name"],["matInput","","formControlName","email","placeholder","Enter Email"],[1,"d-flex","flex-column","gap-2",2,"width","250px"],[1,"input-wrapper","d-flex","gap-3"],["appearance","outline",1,"w-100",2,"position","relative","z-index","2"],["matInput","","type","tel","formControlName","mobile","placeholder","Enter Mobile Number","id","mobile-input-wrapper",3,"keydown.enter","keypress","input","blur","ngClass"],["mat-flat-button","",3,"click"],["class","d-flex flex-column mt-2",4,"ngIf"],[1,"mt-4"],["mat-raised-button","","type","submit",3,"click","disabled"],[1,"d-flex","flex-column","mt-2"],["matInput","","formControlName","otp","placeholder","Enter OTP"],["mat-button","",3,"click"]],template:function(t,e){if(t&1&&(o(0,"div",0)(1,"mat-card",1)(2,"h2",2),u(3,"Login/Register Form"),r(),o(4,"div",3)(5,"form",4)(6,"div",5)(7,"div",6)(8,"mat-form-field",7),g(9,"input",8),f(10,pe,2,0,"mat-error",9),r(),o(11,"mat-form-field",10),g(12,"input",11),f(13,ue,2,0,"mat-error",9),r(),o(14,"mat-form-field",10),g(15,"input",12),f(16,ce,2,0,"mat-error",9),r()(),o(17,"div",13)(18,"div",14)(19,"mat-form-field",15)(20,"input",16),b("keydown.enter",function(){return e.intlPhone!=null&&e.intlPhone.isRequiredValidNumber?e.sendotp():null})("keypress",function(a){return e.intlPhone==null?null:e.intlPhone.onlyPhoneNumber(a)})("input",function(){let a,d;return(a=e.registrationForm.get("user.mobile"))==null||a.setValue(e.intlPhone.phoneNumber),e.intlPhone!=null&&e.intlPhone.isValidNumber||(d=e.registrationForm.get("user.mobile"))==null?null:d.setErrors({invalidNumber:!0})})("blur",function(){let a;return(a=e.registrationForm.get("user.mobile"))==null?null:a.markAsTouched()}),r()()(),o(21,"button",17),b("click",function(){return e.sendotp()}),u(22,"Send"),r(),f(23,de,5,0,"div",18),r(),o(24,"div",19)(25,"button",20),S(26,"async"),b("click",function(){return e.submit()}),u(27,"Submit"),r()()()()()()()),t&2){let i,a,d,y;s(5),p("formGroup",e.registrationForm),s(5),p("ngIf",(i=e.registrationForm.get("user.fname"))==null?null:i.hasError("pattern")),s(3),p("ngIf",(a=e.registrationForm.get("user.lname"))==null?null:a.hasError("pattern")),s(3),p("ngIf",(d=e.registrationForm.get("user.email"))==null?null:d.hasError("pattern")),s(4),p("ngClass",E(9,se,((y=e.registrationForm.get("user.mobile"))==null?null:y.touched)&&!(e.intlPhone!=null&&e.intlPhone.isRequiredValidNumber))),s(3),p("ngIf",e.otpSent),s(2),p("disabled",!P(26,7,e.otpVerified$))}},dependencies:[re,ne,ie,R,O,x,I,U,G,L,A,q,B,j,D,le,oe,te,ee,$,T],styles:["body[_ngcontent-%COMP%]{height:100vh;margin:0;background-color:#7fffd4}.app-content[_ngcontent-%COMP%]{background-color:#fff}button[_ngcontent-%COMP%]{font-size:16px;width:100px}.reg-form[_ngcontent-%COMP%]{min-width:520px;background-color:#fff;box-shadow:#fff;height:640px;width:300px;margin-top:30px}.field[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-wrapper[_ngcontent-%COMP%]{width:100%}@media (max-width: 768px){.reg-form[_ngcontent-%COMP%]{min-width:80%}.reg-form[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{flex-direction:column}}"]})};export{me as RegisterComponent};
